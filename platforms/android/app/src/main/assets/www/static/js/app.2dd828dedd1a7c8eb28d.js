webpackJsonp([1],{0:function(e,t){},"1uuo":function(e,t){},"4L8C":function(e,t){},"5+rQ":function(e,t,n){var o=n("BdVV");function i(e){var t=/^https?\:\/\/(?:(?:(([^:@\/]*)(?::([^@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?).*$/.exec(e);return t&&t[1]}function r(e){var t=null;if(window.btoa){var n=i(e);if(n){t={name:"Authorization",value:"Basic "+window.btoa(n)}}}return t}function s(e){return-1===e.indexOf(" ")}var a=0,c={},l=function(){this._id=++a,this.onprogress=null};l.prototype.upload=function(e,t,n,a,l){if(s(t)){var d=(l=l||{}).fileKey||"file",u=l.fileName||"image.jpg",p=l.mimeType||"image/jpeg",h=l.params||{},v=l.withCredentials||!1,f=l.headers||{},y=l.httpMethod&&"PUT"===l.httpMethod.toUpperCase()?"PUT":"POST",g=r(t);g&&(t=t.replace(i(t)+"@",""),f[g.name]=g.value);var _=this,m=c[this._id]=new XMLHttpRequest;m.withCredentials=v;var w=a&&function(n,i,r){c[this._id]&&delete c[this._id];var s=new o(n,e,t,i,r);a&&a(s)};window.resolveLocalFileSystemURL(e,function(e){e.file(function(e){var i=new FileReader;i.onloadend=function(){var e=new Blob([this.result],{type:p}),i=new FormData;for(var r in i.append(d,e,u),h)h.hasOwnProperty(r)&&i.append(r,h[r]);for(var s in m.open(y,t),f)f.hasOwnProperty(s)&&m.setRequestHeader(s,f[s]);m.onload=function(){if(this.status>=200&&this.status<300){var t=new FileUploadResult;t.bytesSent=e.size,t.responseCode=this.status,t.response=this.response,delete c[_._id],n(t)}else 404===this.status?w(o.INVALID_URL_ERR,this.status,this.response):w(o.CONNECTION_ERR,this.status,this.response)},m.ontimeout=function(){w(o.CONNECTION_ERR,this.status,this.response)},m.onerror=function(){w(o.CONNECTION_ERR,this.status,this.response)},m.onabort=function(){w(o.ABORT_ERR,this.status,this.response)},m.upload.onprogress=function(e){_.onprogress&&_.onprogress(e)},m.send(i),c[_._id]||m.abort()},i.readAsArrayBuffer(e)},function(){w(o.FILE_NOT_FOUND_ERR)})},function(){w(o.FILE_NOT_FOUND_ERR)})}else a&&a(new o(o.INVALID_URL_ERR,e,t))},l.prototype.download=function(e,t,n,a,l,d){if(s(e)){var u=(d=d||{}).headers||{},p=d.withCredentials||!1,h=r(e);h&&(e=e.replace(i(e)+"@",""),u[h.name]=h.value);var v=this,f=c[this._id]=new XMLHttpRequest;f.withCredentials=p;var y=a&&function(n,i,r){if(c[v._id]&&delete c[v._id],r instanceof Blob){var s=new FileReader;s.readAsText(r),s.onloadend=function(r){var s=new o(n,e,t,i,r.target.result);a(s)}}else{var l=new o(n,e,t,i,r);a(l)}};for(var g in f.onload=function(e){var i,r,s=function(){y(o.FILE_NOT_FOUND_ERR)},a=e.target;200!==a.status&&0!==a.status||!a.response?404===a.status?y(o.INVALID_URL_ERR,a.status,a.response):y(o.CONNECTION_ERR,a.status,a.response):window.resolveLocalFileSystemURL((r=(i=t).lastIndexOf("/"),i.substring(0,r+1)),function(e){var i,r;e.getFile((r=(i=t).lastIndexOf("/"),i.substring(r+1)),{create:!0},function(e){e.createWriter(function(t){t.onwriteend=function(t){t.target.error?y(o.FILE_NOT_FOUND_ERR):(e.filesystemName=e.filesystem.name,delete c[v._id],n&&n(e))},t.onerror=function(){y(o.FILE_NOT_FOUND_ERR)},t.write(a.response)},s)},s)},s)},f.onprogress=function(e){v.onprogress&&v.onprogress(e)},f.onerror=function(){y(o.CONNECTION_ERR,this.status,this.response)},f.onabort=function(){y(o.ABORT_ERR,this.status,this.response)},f.open("GET",e,!0),u)u.hasOwnProperty(g)&&f.setRequestHeader(g,u[g]);f.responseType="blob",f.send()}else a&&a(new o(o.INVALID_URL_ERR,e,t))},l.prototype.abort=function(){this instanceof l&&c[this._id]&&(c[this._id].abort(),delete c[this._id])},e.exports=l},BdVV:function(e,t){var n=function(e,t,n,o,i,r){this.code=e||null,this.source=t||null,this.target=n||null,this.http_status=o||null,this.body=i||null,this.exception=r||null};n.FILE_NOT_FOUND_ERR=1,n.INVALID_URL_ERR=2,n.CONNECTION_ERR=3,n.ABORT_ERR=4,n.NOT_MODIFIED_ERR=5,e.exports=n},BxMG:function(e,t){e.exports={timeLine:40,version:.1,playLists:[{src:"https://www.videvo.net/videvo_files/converted/2015_04/preview/Ocean_Waves_slow_motion_videvo.mov44965.webm",title:"It_s_our_ocean",type:"video/webm",category:3},{src:"https://www.videvo.net/videvo_files/converted/2014_07/preview/IT_Sizilien_San_Vito_Lo_Capo_Steinstrand_Mond_4k.mov54542.webm",title:"Sergey",type:"video/webm",category:2},{src:"https://www.videvo.net/videvo_files/converted/2014_10/preview/Rocky_Coastline_3__Videvo.mov65840.webm",title:"Ocean2",type:"video/webm",category:2},{src:"https://www.videvo.net/videvo_files/converted/2017_08/preview/170724_37_Flyingoversurf.mp422204.webm",title:"Ocean_3",type:"video/webm",category:2},{src:"http://94.250.248.196/files/fon/spring3.mp4",title:"Video1",type:"video/mp4",category:3},{src:"http://94.250.248.196/files/fon/spring1.mp4",title:"Video3",type:"video/mp4",category:3}],adverst:[{src:"http://94.250.248.196/files/rec/poolgym.mp4",title:"CU",type:"video/mp4",category:2},{src:"http://94.250.248.196/files/rec/revolution.mp4",title:"It's our",type:"video/mp4",category:3}],patners:[]}},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("VaBq");var o=n("7+uW"),i=n("Gu7T"),r=n.n(i),s=n("bOdI"),a=n.n(s),c=n("63pp"),l=(n("4L8C"),{name:"VideoPlayer",data:function(){var e;return e={timingConfig:n("BxMG"),player:null,advIndex:0,adverstsScope:[],patnersScope:[]},a()(e,"player",null),a()(e,"indexPlaying",0),a()(e,"indexCategory",3),a()(e,"advIteration",[]),a()(e,"appDirectory",""),e},mounted:function(){document.addEventListener("deviceready",this.inizializePlayer,!1)},beforeDestroy:function(){document.removeEventListener("deviceready",this.inizializePlayer)},methods:{storageMovies:function(){var e=this;return this.timingConfig.playLists.map(function(t){return{src:""+e.appDirectory+e.getName(t.src),type:t.type,category:t.category}})},inizializePlayer:function(){var e=this;this.appDirectory=cordova.file.externalRootDirectory+"/playerbook/";var t=0,n=this.storageMovies();console.log(n),this.player=Object(c.a)("playerbook",{sources:n,autoplay:!0});this.player;console.log(this.player),this.player.on("ended",function(o){t++,e.indexCategory=n[t].category,e.player.src(n[t].src),console.log("set src: "+n[t].src),e.player.play()}),this.setupAdvertsVido()},getName:function(e){return e.substring(e.lastIndexOf("/")+1)},setupAdvertsVido:function(){var e=this;console.log("sort video adverts");var t=[];this.adverstsScope=this.timingConfig.adverst.map(function(n,o){console.log(n);var i=""+e.appDirectory+e.getName(n.src);t[n.category]=void 0===t[n.category]?[{name:n.title,src:i}].concat():[].concat(r()(t[n.category]),[{name:n.title,src:i}])}),this.adverstsScope=t,t=[],this.timingConfig.patners.map(function(n,o){var i=""+e.appDirectory+e.getName(n.src);t[n.category]=void 0===t[n.category]?[{name:n.title,src:i}].concat():[].concat(r()(t[n.category]),[{name:n.title,src:i}])}),this.patnersScope=t,setInterval(function(){var t=void 0!==e.advIteration[e.indexCategory]?e.advIteration[e.indexCategory]:0;void 0!==e.adverstsScope[e.indexCategory][t].src&&(e.player.pause(),e.player.src(e.adverstsScope[e.indexCategory][t].src),e.player.play(),e.advIteration[e.indexCategory]++)},1e3*this.timingConfig.timeLine)}}}),d={render:function(){var e=this.$createElement;return(this._self._c||e)("video",{staticClass:"video-js",staticStyle:{width:"100%"},attrs:{height:"300",id:"playerbook",poster:n("iJWo"),playsinline:"",controls:""}})},staticRenderFns:[]},u=n("VU/8")(l,d,!1,null,null,null).exports,p=n("//Fk"),h=n.n(p),v=n("gRE1"),f=n.n(v),y=n("mvHQ"),g=n.n(y),_=n("woOf"),m=n.n(_),w=n("5+rQ"),R=n.n(w),L=n("mtWM"),b=n.n(L);console.log(cordova.file);var C="";function S(e){return e.substring(e.lastIndexOf("/")+1)}var E={data:function(){return{timingConfig:n("BxMG"),downloadLinksScope:[],countCheckVideoUp:0,syncStatus:null,remoteConfig:"http://94.250.248.196:8000/api/V1/GetConfig"}},mounted:function(){this.syncStatus=document.querySelector("#sync-status"),document.addEventListener("deviceready",this.downloadInizialize,!1)},beforeDestroy:function(){document.removeEventListener("deviceready",this.downloadInizialize)},methods:{downloadInizialize:function(){C=cordova.file.externalRootDirectory+"/playerbook/";var e=this.timingConfig.playLists.map(function(e){return{src:e.src,type:e.type,title:e.title}});this.downloadLinksScope=m()([].concat(r()(this.downloadLinksScope),r()(e))),e=this.timingConfig.adverst.map(function(e){return{src:e.src,type:e.type,title:e.title}}),this.downloadLinksScope=m()([].concat(r()(this.downloadLinksScope),r()(e))),e=this.timingConfig.patners.map(function(e){return{src:e.src,type:e.type,title:e.title}}),this.downloadLinksScope=m()([].concat(r()(this.downloadLinksScope),r()(e))),console.log(this.downloadLinksScope);var t=this;b.a.get(this.remoteConfig).then(function(e){e=e.data.config,console.log(e),window.resolveLocalFileSystemURL(cordova.file.externalDataDirectory,function(n){n.getFile("timingConfig.json",{create:!0},function(n){n.createWriter(function(n){n.onwrite=function(e){t.listDir(C).then(function(e){t.inPromiseListDir(e)})},n.write(g()(e))},function(){console.log("not wroten"),t.listDir(C).then(function(e){t.inPromiseListDir(e)})})},function(e){console.log(e)})})}).catch(function(e){console.log(e)})},inPromiseListDir:function(e){var t=this,n=f()(e),o=function(e){var o=S(t.downloadLinksScope[e].src);if(n.includes(o))t.syncStatus.innerHTML+="Видео: "+t.downloadLinksScope[e].title+" - сущуствует <br/>",t.endSynchron(!0);else{var i=document.querySelector("#sync-status"),r=t.downloadLinksScope,s=t;window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(t){t.root.getFile("/playerbook/"+S(r[e].src),{create:!0},function(t){var n=new window.BackgroundTransfer.BackgroundDownloader;console.log("that: "+r[e].src),i.innerHTML+="Проверяю видео: "+S(r[e].src)+" <br/>";var o=n.createDownload(r[e].src,t);app.downloadPromise=o.startAsync().then(function(){s.endSynchron(!0)},function(){console.log("error backgrow download")},function(){console.log("in progress")})})})}};for(var i in this.downloadLinksScope)o(i)},downloadFile:function(e,t){var n=document.querySelector("#sync-status"),o=this.endSynchron;window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(i){i.root.getDirectory("playerbook",{create:!0},function(){var i=""+C+S(e),r=new R.a;r.onprogress=function(e){e.lengthComputable},n.innerHTML+="Проверяю видео: "+t+" <br/>",r.download(e,i,function(e){console.log("download complete: "+e.toURL()),n.innerHTML+="Видео: "+t+" - сохранено <br/>",o(!0)},function(e){n.innerHTML+="Видео: "+t+" - ошибка (проверьте сетевое подключение) <br/>",console.log("ErrorDownload: "+g()(e)),o(!0)},!0,{})})})},listDir:function(e){return new h.a(function(t,n){window.resolveLocalFileSystemURL(e,function(e){e.createReader().readEntries(function(e){var n=e.map(function(e){return e.name});console.log(n),t(n)},function(e){n(e)})})})},getName:function(e){return e.substring(e.lastIndexOf("/")+1)},downloadSuccessCallback:function(){console.log("I'm returned")},downloadErrorCallback:function(e){console.log("Oshibochka "+e)},endSynchron:function(e){e&&this.countCheckVideoUp++;var t=this.downloadLinksScope.length;console.log("iteration: "+this.countCheckVideoUp+" length: "+this.downloadLinksScope.length),this.countCheckVideoUp==t&&this.$emit("sync",!0)}}},N={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"download-container"},[t("div",{staticClass:"loader"}),this._v(" "),t("div",{attrs:{id:"sync-status"}})])}]},I=n("VU/8")(E,N,!1,null,null,null).exports,k={name:"App",components:{VideoPlayer:u,Downloader:I},data:function(){return{endSynchronizationCheck:!1}},methods:{endSynchronization:function(e){this.endSynchronizationCheck=e,console.log("SYNCHRONIZATION IS END: "+e+" ")}}},O={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[this.endSynchronizationCheck?t("VideoPlayer"):this._e(),this._v(" "),this.endSynchronizationCheck?this._e():t("Downloader",{on:{sync:this.endSynchronization}})],1)},staticRenderFns:[]};var D=n("VU/8")(k,O,!1,function(e){n("vQI3")},null,null).exports,T=n("/ocq"),F={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("h1",[e._v(e._s(e.msg))]),e._v(" "),n("h2",[e._v("Essential Links")]),e._v(" "),e._m(0),e._v(" "),n("h2",[e._v("Ecosystem")]),e._v(" "),e._m(1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[n("li",[n("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[e._v("\n        Core Docs\n      ")])]),e._v(" "),n("li",[n("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[e._v("\n        Forum\n      ")])]),e._v(" "),n("li",[n("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank"}},[e._v("\n        Community Chat\n      ")])]),e._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[e._v("\n        Twitter\n      ")])]),e._v(" "),n("br"),e._v(" "),n("li",[n("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[e._v("\n        Docs for This Template\n      ")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[this._v("\n        vue-router\n      ")])]),this._v(" "),t("li",[t("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[this._v("\n        vuex\n      ")])]),this._v(" "),t("li",[t("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[this._v("\n        vue-loader\n      ")])]),this._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[this._v("\n        awesome-vue\n      ")])])])}]};var x=n("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App"}}},F,!1,function(e){n("1uuo")},"data-v-d8ec41bc",null).exports;o.a.use(T.a);var V=new T.a({mode:"history",routes:[{path:"/d",name:"HelloWorld",component:x},{path:"/video.html",name:"VideoPlayer",component:u},{path:"/download",name:"Downloader",component:I}]});o.a.config.productionTip=!1,new o.a({el:"#app",router:V,components:{App:D},template:"<App/>"})},VaBq:function(e,t){},iJWo:function(e,t,n){e.exports=n.p+"static/img/poster.3fe2484.jpg"},vQI3:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2dd828dedd1a7c8eb28d.js.map